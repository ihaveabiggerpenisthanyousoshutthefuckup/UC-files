
          <p>A DHCP spoofing attack occurs when a rogue DHCP server is connected to the network and provides false IP configuration parameters to legitimate clients. DHCP spoofing is dangerous because clients can be leased IP information for malicious DNS server addresses, malicious default gateways, and malicious IP assignments.</p>
          <p></p>
          <p>Security best practices recommend using DHCP snooping to mitigate DHCP spoofing attacks. </p>
          <p></p>
          <p>When DHCP snooping is enabled on an interface or VLAN and a switch receives a DHCP packet on an untrusted port, the switch compares the source packet information with that held in the DHCP Snooping Binding Database. The switch will deny packets containing any of the following information:</p>
          <p></p>
          <p>
            <ul>
              <li>Unauthorized DHCP server messages coming from an untrusted port</li>
            </ul>
          </p>
          <p>
            <ul>
              <li>Unauthorized DHCP client messages not adhering to the DHCP Snooping Binding Database or rate limits</li>
            </ul>
          </p>
          <p></p>
          <p>In a large network, the DHCP Snooping Binding Database may take time to build after it is enabled. For example, it could take two days for DHCP snooping to complete the database if DHCP lease time is four days.</p>
          <p></p>
          <p>DHCP snooping recognizes two types of ports:</p>
          <p></p>
          <p>
            <ul>
              <li>
                <b>Trusted DHCP ports</b> - Only ports connecting to upstream DHCP servers should be trusted. These ports should lead to legitimate DHCP servers replying with DHCP Offer and DHCP Ack messages. Trusted ports must be explicitly identified in the configuration.</li>
            </ul>
          </p>
          <p>
            <ul>
              <li>
                <b>Untrusted ports</b> - These ports connect to hosts that should not be providing DHCP server messages. By default, all switch ports are untrusted.</li>
            </ul>
          </p>
          <p></p>
          <p>The figure provides a visual example of how DHCP snooping ports should be assigned on a network. Notice how the trusted ports always lead to the legitimate DHCP server while all other ports (i.e., access ports connecting to endpoints) are untrusted by default.</p>
          <p></p>
          <p>
            <b>Note</b>: For more information on DHCP snooping, refer to the CCNA Security course.</p>
        