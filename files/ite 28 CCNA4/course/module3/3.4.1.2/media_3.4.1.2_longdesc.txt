The header for a GRE encapsulated packet is shown as five rectangles. The same as the last figure. 5 rectangles adjacent to one another extend from left to right below the topology figure. The 5 rectangles are labeled from left to right as IP, GRE, IP, TCP, and data. The first two (IP and GRE) are the same color. The remaining 3 rectangles are all the same, but a different color from the first two. The GRE rectangle is broken out into two subrectanglesâ€”flags and protocol type. The flags header field identifies the presence of optional header fields. The protocol type filed identifies the type of payload. EtherType 0x800 is used for IPv4.